const AStar = require('../dist/astar.js');
const Heap = require('../dist/heap.js');

class GOAP {
    constructor(agent) {
        this.agent = agent;
    }

    formulate() {
        let goal = this.agent.getGoal();
        let finalActions = [];

        console.log('Formulating plan for ' + goal);

        // TODO allow for composite of actions to accomplish goal
        this.agent.actions.forEach(action => {
            if (action.satisfies(goal)) {
                finalActions.push(action);
            }
        });

        if (finalActions.length === 0) {
            return [];
        }

        let heurFn = (node, root) => 0;
        let goalFn = node => this.agent.stateSatisfies(node);
        let succFn = node => node.chain;
        let costFn = node => node.cost;

        console.log('Starting search with action ' + finalActions[0]);

        let planner = new AStar(heurFn, goalFn, succFn, costFn);
        let path = planner.find(finalActions.pop());
        path.reverse();

        if (path.length === 0) {
            console.log('No plan found!');
        } else {
            console.log('Plan:');
            path.forEach(action => console.log('\t' + action));
        }
    }
}

class Agent {
    constructor() {
        this.planner = new GOAP(this);
        this.goals = new Heap();
        this.actions = [];
        this.state = {};
    }

    getGoal() {
        return this.goals.peek();
    }

    addAction(anAction) {
        this.actions.forEach(action => {
            if (anAction.satisfies(action)) {
                action.chain.push(anAction);
            }
            if (action.satisfies(anAction)) {
                anAction.chain.push(action);
            }
        });

        this.actions.push(anAction);
    }

    stateSatisfies(anIntermediateState) {
        let targetState = anIntermediateState.conditions;

        for (let tsKey in targetState) {
            let tsValue = targetState[tsKey];

            if (this.state[tsKey] != tsValue) {
                return false;
            }
        }

        return true;
    }

    getPlan() {
        return this.planner.formulate();
    }
}

class IntermediateState {
    constructor(key, conditions = {}) {
        this.key = key;
        this.conditions = conditions;
    }

    toString() {
        return this.key;
    }

    satisfies(anIntermediateState) {
        return new Error('An IntermediateState must implement @satisfies( anIntermediateState ).');
    }

    clone() {
        return new Error('An IntermediateState must implement @clone().');
    }
}

class Action extends IntermediateState {
    constructor(key, conditions = {}, effects = {}, cost = 0) {
        super(key, conditions);
        this.effects = effects;
        this.cost = cost;
        this.chain = [];
    }

    satisfies(anIntermediateState) {
        let state = anIntermediateState.conditions;

        for (let eKey in this.effects) {
            let eVal = this.effects[eKey];

            for (let sKey in state) {
                let sVal = state[sKey];

                if (eKey == sKey && eVal == sVal) {
                    return true;
                }
            }
        }

        return false;
    }

    clone() {
        return Object.assign(new Action(), this);
    }
}

class Goal extends IntermediateState {
    constructor(key, conditions = {}, priority = 0) {
        super(key, conditions);
        this.priority = priority;
    }

    clone() {
        return Object.assign(new Goal(), this);
    }
}

module.exports = {
    GOAP: GOAP,
    Agent: Agent,
    Action: Action,
    Goal: Goal };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2NvZGUvcGxhbm5lci5qc3kiXSwibmFtZXMiOlsiQVN0YXIiLCJyZXF1aXJlIiwiSGVhcCIsIkdPQVAiLCJjb25zdHJ1Y3RvciIsImFnZW50IiwiZm9ybXVsYXRlIiwiZ29hbCIsImdldEdvYWwiLCJmaW5hbEFjdGlvbnMiLCJjb25zb2xlIiwibG9nIiwiYWN0aW9ucyIsImZvckVhY2giLCJhY3Rpb24iLCJzYXRpc2ZpZXMiLCJwdXNoIiwibGVuZ3RoIiwiaGV1ckZuIiwibm9kZSIsInJvb3QiLCJnb2FsRm4iLCJzdGF0ZVNhdGlzZmllcyIsInN1Y2NGbiIsImNoYWluIiwiY29zdEZuIiwiY29zdCIsInBsYW5uZXIiLCJwYXRoIiwiZmluZCIsInBvcCIsInJldmVyc2UiLCJBZ2VudCIsImdvYWxzIiwic3RhdGUiLCJwZWVrIiwiYWRkQWN0aW9uIiwiYW5BY3Rpb24iLCJhbkludGVybWVkaWF0ZVN0YXRlIiwidGFyZ2V0U3RhdGUiLCJjb25kaXRpb25zIiwidHNLZXkiLCJ0c1ZhbHVlIiwiZ2V0UGxhbiIsIkludGVybWVkaWF0ZVN0YXRlIiwia2V5IiwidG9TdHJpbmciLCJFcnJvciIsImNsb25lIiwiQWN0aW9uIiwiZWZmZWN0cyIsImVLZXkiLCJlVmFsIiwic0tleSIsInNWYWwiLCJPYmplY3QiLCJhc3NpZ24iLCJHb2FsIiwicHJpb3JpdHkiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxRQUFRQyxRQUFVLGtCQUFWLENBQWQ7QUFDQSxNQUFNQyxPQUFPRCxRQUFVLGlCQUFWLENBQWI7O0FBR0EsTUFBTUUsSUFBTixDQUFXO0FBQ1BDLGdCQUFhQyxLQUFiLEVBQXFCO0FBQ2pCLGFBQUtBLEtBQUwsR0FBYUEsS0FBYjtBQUFrQjs7QUFFdEJDLGdCQUFZO0FBQ1IsWUFBSUMsT0FBTyxLQUFLRixLQUFMLENBQVdHLE9BQVgsRUFBWDtBQUNBLFlBQUlDLGVBQWUsRUFBbkI7O0FBRUFDLGdCQUFRQyxHQUFSLENBQWMsMEJB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LGdCQUFheUMsR0FBYixFQUFrQkwsYUFBVyxFQUE3QixFQUFpQ2tCLFdBQVMsQ0FBMUMsRUFBOEM7QUFDMUMsY0FBUWIsR0FBUixFQUFhTCxVQUFiO0FBQ0EsYUFBS2tCLFFBQUwsR0FBZ0JBLFFBQWhCO0FBQXdCOztBQUU1QlYsWUFBUTtBQUFHLGVBQU9PLE9BQU9DLE1BQVAsQ0FBZ0IsSUFBSUMsSUFBSixFQUFoQixFQUE0QixJQUE1QixDQUFQO0FBQXVDO0FBTGpCOztBQVFyQ0UsT0FBT0MsT0FBUCxHQUFpQjtBQUNiekQsVUFBTUEsSUFETztBQUVYNkIsV0FBT0EsS0FGSTtBQUdYaUIsWUFBUUEsTUFIRztBQUlYUSxVQUFNQSxJQUpLLEVBQWpCIiwiZmlsZSI6InBsYW5uZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBBU3RhciA9IHJlcXVpcmUgQCAnLi4vZGlzdC9hc3Rhci5qcydcbmNvbnN0IEhlYXAgPSByZXF1aXJlIEAgJy4uL2Rpc3QvaGVhcC5qcydcblxuXG5jbGFzcyBHT0FQIDo6XG4gICAgY29uc3RydWN0b3IoIGFnZW50ICkgOjpcbiAgICAgICAgdGhpcy5hZ2VudCA9IGFnZW50XG5cbiAgICBmb3JtdWxhdGUoKSA6OlxuICAgICAgICBsZXQgZ29hbCA9IHRoaXMuYWdlbnQuZ2V0R29hbCgpXG4gICAgICAgIGxldCBmaW5hbEFjdGlvbnMgPSBbXVxuXG4gICAgICAgIGNvbnNvbGUubG9nIEAgJ0Zvcm11bGF0aW5nIHBsYW4gZm9yICcgKyBnb2FsXG5cbiAgICAgICAgLy8gVE9ETyBhbGxvdyBmb3IgY29tcG9zaXRlIG9mIGFjdGlvbnMgdG8gYWNjb21wbGlzaCBnb2FsXG4gICAgICAgIHRoaXMuYWdlbnQuYWN0aW9ucy5mb3JFYWNoIEAgKCBhY3Rpb24gKSA9PiA6OlxuICAgICAgICAgICAgaWYgYWN0aW9uLnNhdGlzZmllcyBAIGdvYWwgOjogZmluYWxBY3Rpb25zLnB1c2ggQCBhY3Rpb25cblxuICAgICAgICBpZiBmaW5hbEFjdGlvbnMubGVuZ3RoID09PSAwIDo6IHJldHVybiBbXVxuXG4gICAgICAgIGxldCBoZXVyRm4gPSAoIG5vZGUsIHJvb3QgKSA9PiAwXG4gICAgICAgIGxldCBnb2FsRm4gPSBub2RlID0+IHRoaXMuYWdlbnQuc3RhdGVTYXRpc2ZpZXMgQCBub2RlXG4gICAgICAgIGxldCBzdWNjRm4gPSBub2RlID0+IG5vZGUuY2hhaW5cbiAgICAgICAgbGV0IGNvc3RGbiA9IG5vZGUgPT4gbm9kZS5jb3N0XG5cbiAgICAgICAgY29uc29sZS5sb2cgQCAnU3RhcnRpbmcgc2VhcmNoIHdpdGggYWN0aW9uICcgKyBmaW5hbEFjdGlvbnNbMF1cblxuICAgICAgICBsZXQgcGxhbm5lciA9IG5ldyBBU3RhciBAIGhldXJGbiwgZ29hbEZuLCBzdWNjRm4sIGNvc3RGblxuICAgICAgICBsZXQgcGF0aCA9IHBsYW5uZXIuZmluZCBAIGZpbmFsQWN0aW9ucy5wb3AoKVxuICAgICAgICBwYXRoLnJldmVyc2UoKVxuXG5cbiAgICAgICAgaWYgcGF0aC5sZW5ndGggPT09IDAgOjpcbiAgICAgICAgICAgIGNvbnNvbGUubG9nIEAgJ05vIHBsYW4gZm91bmQhJ1xuICAgICAgICBlbHNlIDo6XG4gICAgICAgICAgICBjb25zb2xlLmxvZyBAICdQbGFuOidcbiAgICAgICAgICAgIHBhdGguZm9yRWFjaCBAIGFjdGlvbiA9PiBjb25zb2xlLmxvZyBAICdcXHQnICsgYWN0aW9uXG5cblxuY2xhc3MgQWdlbnQgOjpcbiAgICBjb25zdHJ1Y3RvcigpIDo6XG4gICAgICAgIHRoaXMucGxhbm5lciA9IG5ldyBHT0FQIEAgdGhpc1xuICAgICAgICB0aGlzLmdvYWxzID0gbmV3IEhlYXAoKVxuICAgICAgICB0aGlzLmFjdGlvbnMgPSBbXVxuICAgICAgICB0aGlzLnN0YXRlID0ge31cblxuICAgIGdldEdvYWwoKSA6OiByZXR1cm4gdGhpcy5nb2Fscy5wZWVrKClcblxuICAgIGFkZEFjdGlvbiggYW5BY3Rpb24gKSA6OlxuICAgICAgICB0aGlzLmFjdGlvbnMuZm9yRWFjaCBAIGFjdGlvbiA9PiA6OlxuICAgICAgICAgICAgaWYgYW5BY3Rpb24uc2F0aXNmaWVzIEAgYWN0aW9uIDo6IGFjdGlvbi5jaGFpbi5wdXNoIEAgYW5BY3Rpb25cbiAgICAgICAgICAgIGlmIGFjdGlvbi5zYXRpc2ZpZXMgQCBhbkFjdGlvbiA6OiBhbkFjdGlvbi5jaGFpbi5wdXNoIEAgYWN0aW9uXG5cbiAgICAgICAgdGhpcy5hY3Rpb25zLnB1c2ggQCBhbkFjdGlvblxuXG4gICAgc3RhdGVTYXRpc2ZpZXMoIGFuSW50ZXJtZWRpYXRlU3RhdGUgKSA6OlxuICAgICAgICBsZXQgdGFyZ2V0U3RhdGUgPSBhbkludGVybWVkaWF0ZVN0YXRlLmNvbmRpdGlvbnNcblxuICAgICAgICBmb3IgbGV0IHRzS2V5IGluIHRhcmdldFN0YXRlIDo6XG4gICAgICAgICAgICBsZXQgdHNWYWx1ZSA9IHRhcmdldFN0YXRlW3RzS2V5XVxuXG4gICAgICAgICAgICBpZiB0aGlzLnN0YXRlW3RzS2V5XSAhPSB0c1ZhbHVlIDo6IHJldHVybiBmYWxzZVxuXG4gICAgICAgIHJldHVybiB0cnVlXG5cbiAgICBnZXRQbGFuKCkgOjogcmV0dXJuIHRoaXMucGxhbm5lci5mb3JtdWxhdGUoKVxuICAgICAgICBcblxuXG5jbGFzcyBJbnRlcm1lZGlhdGVTdGF0ZSA6OlxuICAgIGNvbnN0cnVjdG9yKCBrZXksIGNvbmRpdGlvbnM9e30gKSA6OlxuICAgICAgICB0aGlzLmtleSA9IGtleVxuICAgICAgICB0aGlzLmNvbmRpdGlvbnMgPSBjb25kaXRpb25zXG5cbiAgICB0b1N0cmluZygpIDo6IHJldHVybiB0aGlzLmtleVxuXG4gICAgc2F0aXNmaWVzKCBhbkludGVybWVkaWF0ZVN0YXRlICkgOjogcmV0dXJuIG5ldyBFcnJvciBAICdBbiBJbnRlcm1lZGlhdGVTdGF0ZSBtdXN0IGltcGxlbWVudCBAc2F0aXNmaWVzKCBhbkludGVybWVkaWF0ZVN0YXRlICkuJ1xuXG4gICAgY2xvbmUoKSA6OiByZXR1cm4gbmV3IEVycm9yIEAgJ0FuIEludGVybWVkaWF0ZVN0YXRlIG11c3QgaW1wbGVtZW50IEBjbG9uZSgpLidcblxuXG5jbGFzcyBBY3Rpb24gZXh0ZW5kcyBJbnRlcm1lZGlhdGVTdGF0ZSA6OlxuICAgIGNvbnN0cnVjdG9yKCBrZXksIGNvbmRpdGlvbnM9e30sIGVmZmVjdHM9e30sIGNvc3Q9MCApIDo6XG4gICAgICAgIHN1cGVyIEAga2V5LCBjb25kaXRpb25zXG4gICAgICAgIHRoaXMuZWZmZWN0cyA9IGVmZmVjdHNcbiAgICAgICAgdGhpcy5jb3N0ID0gY29zdFxuICAgICAgICB0aGlzLmNoYWluID0gW11cblxuICAgIHNhdGlzZmllcyggYW5JbnRlcm1lZGlhdGVTdGF0ZSApIDo6XG4gICAgICAgIGxldCBzdGF0ZSA9IGFuSW50ZXJtZWRpYXRlU3RhdGUuY29uZGl0aW9uc1xuICAgICAgICBcbiAgICAgICAgZm9yIGxldCBlS2V5IGluIHRoaXMuZWZmZWN0cyA6OlxuICAgICAgICAgICAgbGV0IGVWYWwgPSB0aGlzLmVmZmVjdHNbZUtleV1cblxuICAgICAgICAgICAgZm9yIGxldCBzS2V5IGluIHN0YXRlIDo6XG4gICAgICAgICAgICAgICAgbGV0IHNWYWwgPSBzdGF0ZVtzS2V5XVxuXG4gICAgICAgICAgICAgICAgaWYgZUtleSA9PSBzS2V5ICYmIGVWYWwgPT0gc1ZhbCA6OiByZXR1cm4gdHJ1ZVxuXG4gICAgICAgIHJldHVybiBmYWxzZVxuXG4gICAgY2xvbmUoKSA6OiByZXR1cm4gT2JqZWN0LmFzc2lnbiBAIG5ldyBBY3Rpb24oKSwgdGhpc1xuXG5cbmNsYXNzIEdvYWwgZXh0ZW5kcyBJbnRlcm1lZGlhdGVTdGF0ZSA6OlxuICAgIGNvbnN0cnVjdG9yKCBrZXksIGNvbmRpdGlvbnM9e30sIHByaW9yaXR5PTAgKSA6OlxuICAgICAgICBzdXBlciBAIGtleSwgY29uZGl0aW9uc1xuICAgICAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHlcblxuICAgIGNsb25lKCkgOjogcmV0dXJuIE9iamVjdC5hc3NpZ24gQCBuZXcgR29hbCgpLCB0aGlzXG5cblxubW9kdWxlLmV4cG9ydHMgPSA6OlxuICAgIEdPQVA6IEdPQVBcbiAgICAsIEFnZW50OiBBZ2VudFxuICAgICwgQWN0aW9uOiBBY3Rpb25cbiAgICAsIEdvYWw6IEdvYWxcbiJdfQ==